CALL SYSPROC.ADMIN_CMD('REORG TABLE STUCENTR.Lab');

SELECT * FROM STUCENTR.Student;

SELECT * FROM STUCENTR.Professor;

SELECT * FROM STUCENTR.Program;

SELECT * FROM STUCENTR.ProgramEnrollment;

SELECT * FROM STUCENTR.Course;

SELECT * FROM STUCENTR.Enrollment;

SELECT * FROM STUCENTR.PrevEnrollment;

SELECT * FROM STUCENTR.Prerequisite;

SELECT * FROM STUCENTR.ProgramReq;

SELECT * FROM STUCENTR.Location;

SELECT * FROM STUCENTR.Room;

SELECT * FROM STUCENTR.Lecture;

SELECT * FROM STUCENTR.LectureEnrollment;

SELECT * FROM STUCENTR.Lab;

SELECT * FROM STUCENTR.LabEnrollment;

SELECT * FROM STUCENTR.Grade;

SELECT StudentID FROM STUCENTR.Student;

UPDATE STUCENTR.Course
SET CourseID = 'PHIL2343E'
WHERE CourseID  = '2343E';

UPDATE STUCENTR.Course
SET CourseID = 'MATH1000'
WHERE CourseID  = 'CALC1000';

INSERT INTO STUCENTR.Program (ProgramID, ProgramName) VALUES (010, 'Law');
INSERT INTO STUCENTR.Program (ProgramID, ProgramName) VALUES (015, 'History');
INSERT INTO STUCENTR.Professor (ProfessorID, ProgramID, FirstName, LastName) VALUES (563327890, 15, 'Napolean', 'Bonaparte');
INSERT INTO STUCENTR.Professor (ProfessorID, ProgramID, FirstName, LastName) VALUES (975342983, 14, 'Pablo', 'Picasso');

SELECT DISTINCT(STUDENTID) FROM STUCENTR.PREVENROLLMENT;

DELETE FROM STUCENTR.Enrollment WHERE CourseID = 'PSY2032';

SELECT G.GRADE, C.COURSENAME, C.COURSEID
      FROM STUCENTR.GRADE G
      INNER JOIN STUCENTR.PREVENROLLMENT PE ON PE.PREVENROLLMENTID = G.PREVENROLLMENTID
      INNER JOIN STUCENTR.STUDENT S ON S.STUDENTID = PE.STUDENTID
      INNER JOIN STUCENTR.COURSE C ON C.COURSEID = PE.COURSEID
      WHERE S.STUDENTID = 823321975;

INSERT INTO STUCENTR.Enrollment (EnrollmentID, CourseID, StudentID) VALUES (986234, 'CS2212', 823321975);
INSERT INTO STUCENTR.Enrollment (EnrollmentID, CourseID, StudentID) VALUES (491234, 'CS2208', 823321975);
INSERT INTO STUCENTR.Enrollment (EnrollmentID, CourseID, StudentID) VALUES (218423, 'CS2209', 823321975);
INSERT INTO STUCENTR.Enrollment (EnrollmentID, CourseID, StudentID) VALUES (231943, 'HIS2177', 823321975);
INSERT INTO STUCENTR.Enrollment (EnrollmentID, CourseID, StudentID) VALUES (732145, 'PHIL2343E', 823321975);


INSERT INTO STUCENTR.Course (CourseID, ProgramID, ProfessorID, CourseName, Credit) VALUES ('PSY2032', 3, 918194875, 'Psych Of Crime & Corrections', 1);
UPDATE STUCENTR.Course 
SET ProgramID = 15
WHERE ProfessorID = 563327890;

INSERT INTO STUCENTR.Course (CourseID, ProgramID, ProfessorID, CourseName, Credit) VALUES ('MATH1600', 11, 438169386, 'Linear Algebra', 1);

INSERT INTO STUCENTR.Course (CourseID, 

DELETE FROM STUCENTR.Lecture;

DELETE FROM STUCENTR.LabEnrollment;
DELETE FROM STUCENTR.Lab;

SELECT CourseID FROM STUCENTR.Enrollment WHERE StudentID = 823321975;

INSERT INTO STUCENTR.PrevEnrollment (PrevEnrollmentID, StudentID, CourseID) VALUES (74091, 823321975, 'PSY1002');

DROP TABLE STUCENTR.Grade;

SELECT * FROM STUCENTR.PREVENROLLMENT;
SELECT * FROM STUCENTR.GRADES;

UPDATE STUCENTR.PrevEnrollment
SET PREVENROLLMENTID = 589346
WHERE PREVENROLLMENTID  = 58934;

UPDATE STUCENTR.Grade
SET PREVENROLLMENTID = 589346
WHERE PREVENROLLMENTID  = 58934;

DELETE FROM STUCENTR.PrevEnrollment WHERE PrevEnrollmentID = 58934;
DELETE FROM STUCENTR.PrevEnrollment WHERE PrevEnrollmentID = 65987;
DELETE FROM STUCENTR.PrevEnrollment WHERE PrevEnrollmentID = 74916;
DELETE FROM STUCENTR.PrevEnrollment WHERE PrevEnrollmentID = 81945;
DELETE FROM STUCENTR.PrevEnrollment WHERE PrevEnrollmentID = 65704;
DELETE FROM STUCENTR.PrevEnrollment WHERE PrevEnrollmentID = 17492;
DELETE FROM STUCENTR.PrevEnrollment WHERE PrevEnrollmentID = 74091;

INSERT INTO STUCENTR.PrevEnrollment (PrevEnrollmentID, StudentID, CourseID, Year) VALUES (589346, 823321975, 'CS1026', 2022);
INSERT INTO STUCENTR.PrevEnrollment (PrevEnrollmentID, StudentID, CourseID, Year) VALUES (659873, 823321975, 'CALC1000', 2022);
INSERT INTO STUCENTR.PrevEnrollment (PrevEnrollmentID, StudentID, CourseID, Year) VALUES (749166, 823321975, 'MATH1600', 2022);
INSERT INTO STUCENTR.PrevEnrollment (PrevEnrollmentID, StudentID, CourseID, Year) VALUES (819459, 823321975, 'CS1027', 2022);
INSERT INTO STUCENTR.PrevEnrollment (PrevEnrollmentID, StudentID, CourseID, Year) VALUES (657046, 823321975, 'FILM1022', 2022);
INSERT INTO STUCENTR.PrevEnrollment (PrevEnrollmentID, StudentID, CourseID, Year) VALUES (174929, 823321975, 'ART1646', 2022);
INSERT INTO STUCENTR.PrevEnrollment (PrevEnrollmentID, StudentID, CourseID, Year) VALUES (740914, 823321975, 'PSY1002', 2022);

INSERT INTO STUCENTR.Grade (PrevEnrollmentID, Grade) VALUES (589346, 96);
INSERT INTO STUCENTR.Grade (PrevEnrollmentID, Grade) VALUES (174929, 78);
INSERT INTO STUCENTR.Grade (PrevEnrollmentID, Grade) VALUES (657046, 90);
INSERT INTO STUCENTR.Grade (PrevEnrollmentID, Grade) VALUES (659873, 94);
INSERT INTO STUCENTR.Grade (PrevEnrollmentID, Grade) VALUES (740914, 86);
INSERT INTO STUCENTR.Grade (PrevEnrollmentID, Grade) VALUES (749166, 84);
INSERT INTO STUCENTR.Grade (PrevEnrollmentID, Grade) VALUES (819459, 78);

SELECT * FROM STUCENTR.Grade;

      SELECT L.*, P.FIRSTNAME, P.LASTNAME
      FROM STUCENTR.Lab L
      INNER JOIN STUCENTR.LabEnrollment LE ON L.LabID = LE.LabID
      INNER JOIN STUCENTR.Professor P ON L.ProfessorID = P.ProfessorID
      WHERE LE.StudentID = 823321975;

CREATE TABLE STUCENTR.Grade(
	PrevEnrollmentID INT NOT NULL,
	Grade INT NOT NULL,
	FOREIGN KEY(PrevEnrollmentID) REFERENCES STUCENTR.PrevEnrollment(PrevEnrollmentID),
	PRIMARY KEY (PrevEnrollmentID)
	);
	
SELECT c.COURSEID, c.ESSAYCREDIT, l.STARTTIME, l.ENDTIME, l.WEEKDAY, l.STARTDATE, l.ENDDATE, c.BREADTH
FROM STUCENTR.Course c
JOIN STUCENTR.Lecture l ON c.COURSEID = l.COURSEID
WHERE c.BREADTH IN ('ST', 'SS', 'AH');


CREATE TABLE STUCENTR.Student (
	StudentID INT PRIMARY KEY NOT NULL,
	Email VARCHAR(255) UNIQUE NOT NULL,
	Pass VARCHAR(255) NOT NULL,
	Phone VARCHAR(20),
	FirstName VARCHAR(100),
	LastName VARCHAR(100)
);

SELECT 
            s.StudentID,
            c.CourseID,
            c.CourseName,
            c.Breadth,
            c.EssayCredit
        FROM 
            STUCENTR.Student s
        JOIN 
            STUCENTR.Enrollment e ON s.StudentID = e.StudentID
        JOIN 
            STUCENTR.Course c ON e.CourseID = c.CourseID
        WHERE 
            s.StudentID = 823321975 AND (c.Breadth IS NOT NULL OR c.EssayCredit IS NOT NULL)
        UNION
        SELECT 
            s.StudentID,
            c.CourseID,
            c.CourseName,
            c.Breadth,
            c.EssayCredit
        FROM 
            STUCENTR.Student s
        JOIN 
            STUCENTR.PrevEnrollment pe ON s.StudentID = pe.StudentID
        JOIN 
            STUCENTR.Course c ON pe.CourseID = c.CourseID
        WHERE 
            s.StudentID = 823321975 AND (c.Breadth IS NOT NULL OR c.EssayCredit IS NOT NULL)
        ORDER BY 
            CourseID;

-- Step 1: Drop the primary key constraint
ALTER TABLE STUCENTR.Course
DROP PRIMARY KEY;

-- Step 2: Alter the CourseID column
ALTER TABLE STUCENTR.Course
ALTER COLUMN CourseID SET DATA TYPE VARCHAR(100);

CALL SYSPROC.ADMIN_CMD('REORG TABLE STUCENTR.Course');

-- Step 3: Add the primary key constraint back
ALTER TABLE STUCENTR.Course
ADD PRIMARY KEY (CourseID);

ALTER TABLE STUCENTR.Lab
ADD COLUMN EndDate DATE;

CREATE TABLE STUCENTR.Course (
	CourseID VARCHAR(100) PRIMARY KEY NOT NULL,
	ProgramID INT,
	ProfessorID INT,
	CourseName VARCHAR(255),
	Credit INT,
	FOREIGN KEY (ProgramID) REFERENCES STUCENTR.Program(ProgramID),
	FOREIGN KEY (ProfessorID) REFERENCES STUCENTR.Professor(ProfessorID)
);

ALTER TABLE STUCENTR.Course
DROP COLUMN EndTime;

CREATE TABLE STUCENTR.Program (
	ProgramID INT PRIMARY KEY NOT NULL,
	ProgramName VARCHAR(255)
);

CREATE TABLE STUCENTR.ProgramEnrollment(
	ProgramEnrollmentID INT PRIMARY KEY NOT NULL,
	StudentID INT, 
	ProgramID INT,
	FOREIGN KEY (StudentID) REFERENCES STUCENTR.Student(StudentID),
	FOREIGN KEY (ProgramID) REFERENCES STUCENTR.Program(ProgramID)
);

INSERT INTO STUCENTR.ProgramEnrollment (ProgramEnrollmentID, StudentID, ProgramID) VALUES (43299, 607755715, 2);

CREATE TABLE STUCENTR.Enrollment(
	EnrollmentID INT PRIMARY KEY NOT NULL,
	StudentID INT,
	CourseID INT,
	FOREIGN KEY (StudentID) REFERENCES STUCENTR.Student(StudentID),
	FOREIGN KEY (CourseID) REFERENCES STUCENTR.Course(CourseID)
);

CREATE TABLE STUCENTR.PrevEnrollment(
	PrevEnrollmentID INT PRIMARY KEY NOT NULL,
	StudentID INT,
	CourseID VARCHAR(100),
	FOREIGN KEY (StudentID) REFERENCES STUCENTR.Student(StudentID),
	FOREIGN KEY (CourseID) REFERENCES STUCENTR.Course(CourseID)
);

INSERT INTO STUCENTR.PrevEnrollment (PrevEnrollmentID, StudentID, CourseID) VALUES (781237, 823321975, 'ART1020');

SELECT * FROM STUCENTR.Course;
SELECT * FROM STUCENTR.PrevEnrollment;
SELECT * FROM STUCENTR.Program;
SELECT * FROM STUCENTR.Professor;

INSERT INTO STUCENTR.Course (CourseID, ProgramID, ProfessorID, CourseName, Credit, EssayCredit) VALUES ('HIS1000', 15, 563327890, 'Classical Civilization', 1, 'N');

INSERT INTO STUCENTR.Professor (ProfessorID, ProgramID, FirstName, LastName) VALUES (543289043, 6, 'Friedrich', 'Nietzsche'); 

INSERT INTO STUCENTR.Enrollment (EnrollmentID, StudentID, CourseID) VALUES (43215, 823321975, 'CS1026');

ALTER TABLE STUCENTR.Enrollment ALTER COLUMN CourseID SET DATA TYPE VARCHAR(100);

INSERT INTO STUCENTR.Program (ProgramID, ProgramName) VALUES (12, 'English');

INSERT INTO STUCENTR.Course (CourseID, ProgramID, ProfessorID, CourseName, Credit) VALUES ('2343E', 12, 543289043, 'What is Life? The Philosophy Of Nature, Being, and Reality', 1);

ALTER TABLE STUCENTR.Enrollment
ADD CONSTRAINT CourseID
FOREIGN KEY (CourseID) REFERENCES STUCENTR.Course(CourseID);

CREATE TABLE STUCENTR.Grade (
	EnrollmentID INT PRIMARY KEY NOT NULL,
	PercentageGrade INT,
	FOREIGN KEY (EnrollmentID) REFERENCES STUCENTR.Enrollment(EnrollmentID)
);

SELECT 
    s.StudentID,
    c.CourseID,
    c.CourseName,
    c.Breadth,
    c.EssayCredit
FROM 
    STUCENTR.Student s
JOIN 
    STUCENTR.Enrollment e ON s.StudentID = e.StudentID
JOIN 
    STUCENTR.Course c ON e.CourseID = c.CourseID
WHERE 
    s.StudentID = 823321975 AND (c.Breadth IS NOT NULL OR c.EssayCredit IS NOT NULL)
UNION
SELECT 
    s.StudentID,
    c.CourseID,
    c.CourseName,
    c.Breadth,
    c.EssayCredit
FROM 
    STUCENTR.Student s
JOIN 
    STUCENTR.PrevEnrollment pe ON s.StudentID = pe.StudentID
JOIN 
    STUCENTR.Course c ON pe.CourseID = c.CourseID
WHERE 
    s.StudentID = 823321975 AND (c.Breadth IS NOT NULL OR c.EssayCredit IS NOT NULL)
ORDER BY 
    CourseID;


CREATE TABLE STUCENTR.Professor(
	ProfessorID INT PRIMARY KEY NOT NULL,
	ProgramID INT,
	FirstName VARCHAR(100),
	LastName VARCHAR(100),
	FOREIGN KEY (ProgramID) REFERENCES STUCENTR.Program(ProgramID)
);

UPDATE STUCENTR.PrevEnrollment
SET YEAR = 2022
WHERE COURSEID  = 'ART1045';
UPDATE STUCENTR.PrevEnrollment
SET YEAR = 2022
WHERE COURSEID  = 'ART1020';

SELECT * FROM STUCENTR.PREVENROLLMENT;

UPDATE STUCENTR.Lecture
SET ENDTIME = '12:30:00'
WHERE LECTUREID  = 5953698;
UPDATE STUCENTR.Lecture
SET WEEKDAY = 2
WHERE LECTUREID  = 5953698;

SELECT * FROM STUCENTR.Lecture;
SELECT * FROM STUCENTR.Lab;

ALTER TABLE STUCENTR.Student DROP COLUMN ESSAYCREDIT;

CREATE TABLE STUCENTR.Prerequisite (
	CourseID VARCHAR(100)NOT NULL, 
	PrerequisiteID VARCHAR(100) NOT NULL,
	FOREIGN KEY (CourseID) REFERENCES STUCENTR.Course(CourseID),
	FOREIGN KEY (PrerequisiteID) REFERENCES STUCENTR.Course(CourseID),
	PRIMARY KEY(CourseID, PrerequisiteID)
);

DROP TABLE STUCENTR.Prerequisite;

DELETE FROM STUCENTR.Lecture WHERE CourseID = 'CS2209';
DELETE FROM STUCENTR.LectureEnrollment WHERE LectureID = 93847;

INSERT INTO STUCENTR.Prerequisite (CourseID, PrerequisiteID) VALUES ('CS1027', 'CS1026');

DELETE FROM STUCENTR.Student WHERE StudentID = 116889234;

INSERT INTO STUCENTR.Prerequisite (CourseID, PrerequisiteID) VALUES ('CS3377', 'CS1027');
INSERT INTO STUCENTR.Prerequisite (CourseID, PrerequisiteID) VALUES ('CS3377', 'CALC1000');
INSERT INTO STUCENTR.Prerequisite (CourseID, PrerequisiteID) VALUES ('CS3377', 'MATH1600');
INSERT INTO STUCENTR.Prerequisite (CourseID, PrerequisiteID) VALUES ('CS3350', 'CS2209');


ALTER TABLE STUCENTR.Prerequisite DROP PRIMARY KEY;

ALTER TABLE STUCENTR.Prerequisite ALTER COLUMN CourseID SET DATA TYPE VARCHAR(100);

ALTER TABLE STUCENTR.Prerequisite 
ADD PRIMARY KEY (CourseID, PrerequisiteID);

CREATE TABLE STUCENTR.ProgramReq (
	ProgramID INT NOT NULL,
	CourseID INT NOT NULL,
	FOREIGN KEY (ProgramID) REFERENCES STUCENTR.Program(ProgramID),
	FOREIGN KEY (CourseID) REFERENCES STUCENTR.Course(CourseID),
	PRIMARY KEY (ProgramID, CourseID)
);

CREATE TABLE STUCENTR.Location (
    LocationID VARCHAR(10) PRIMARY KEY NOT NULL,
    LocationName VARCHAR(100) NOT NULL
);

INSERT INTO STUCENTR.Location (LocationID, LocationName) VALUES ('NATSCI', 'Natural Sciences Center');

CREATE TABLE STUCENTR.Room (
    RoomID VARCHAR(10) PRIMARY KEY NOT NULL, 
    LocationID VARCHAR(10) NOT NULL,
    RoomNumber INT,
    Capacity INT,
    FOREIGN KEY (LocationID) REFERENCES STUCENTR.Location(LocationID)
);

ALTER TABLE STUCENTR.Room
DROP COLUMN RoomNumber;

ALTER TABLE STUCENTR.Enrollment
ADD COLUMN Year INT;

INSERT INTO STUCENTR.Room (RoomID, LocationID, Capacity, RoomNumber) VALUES ('MC105', 'MC', 144, 105);

CREATE TABLE STUCENTR.Lecture (
    LectureID INT NOT NULL,
    CourseID VARCHAR(10) NOT NULL,
    ProfessorID INT NOT NULL,
    RoomID VARCHAR(10) NOT NULL,
    StartTime TIMESTAMP NOT NULL,
    EndTime TIMESTAMP NOT NULL,
    Weekday INT NOT NULL,
    FOREIGN KEY (CourseID) REFERENCES STUCENTR.Course(CourseID),
    FOREIGN KEY (ProfessorID) REFERENCES STUCENTR.Professor(ProfessorID),
    FOREIGN KEY (RoomID) REFERENCES STUCENTR.Room(RoomID),
    PRIMARY KEY(LectureID, CourseID)
);

CREATE TABLE STUCENTR.LectureEnrollment (
    LectureID INT NOT NULL,
    CourseID VARCHAR(10) NOT NULL,
    StudentID INT NOT NULL,
    FOREIGN KEY (LectureID, CourseID) REFERENCES STUCENTR.Lecture(LectureID, CourseID),
    FOREIGN KEY (StudentID) REFERENCES STUCENTR.Student(StudentID),
    PRIMARY KEY (StudentID, LectureID, CourseID)
);

INSERT INTO STUCENTR.LectureEnrollment (LectureID, CourseID, StudentID) VALUES (2576153, 'PHIL2343E', 823321975);
INSERT INTO STUCENTR.LabEnrollment (LabID, CourseID, StudentID) VALUES (1294114, 'CS2208', 823321975);

SELECT * FROM STUCENTR.Lecture;
SELECT * FROM STUCENTR.LectureEnrollment;

SELECT * FROM STUCENTR.Lab;
SELECT * FROM STUCENTR.LabEnrollment;

ALTER TABLE STUCENTR.Lab DROP COLUMN AttendanceDate; 

DELETE FROM STUCENTR.LectureEnrollment WHERE LectureID = 7275206;

UPDATE STUCENTR.LectureEnrollment
SET LectureID = 2576153
WHERE LectureID = 7275206;

SELECT L.*
FROM STUCENTR.Lecture L
INNER JOIN STUCENTR.LectureEnrollment LE ON L.LectureID = LE.LectureID
WHERE LE.StudentID = 823321975
  AND LE.CourseID = 'CS1026';


ALTER TABLE STUCENTR.Lab
DROP COLUMN StartTime;

ALTER TABLE STUCENTR.Lab
ADD COLUMN StartTime TIME;

ALTER TABLE STUCENTR.Lecture
ADD COLUMN StartDate DATE;
ALTER TABLE STUCENTR.Lecture
ADD COLUMN EndDate DATE;

UPDATE STUCENTR.Lab 
SET Weekday = 2
WHERE LabID = 5516824;

UPDATE STUCENTR.Room
SET RoomNumber = 117, Capacity = 122
WHERE RoomID = 'NCB117';

INSERT INTO STUCENTR.Location (LocationID, LocationName) VALUES ('UC', 'University College');
INSERT INTO STUCENR.Room (

INSERT INTO STUCENTR.Lecture (LectureID, CourseID, ProfessorID, RoomID, StartTime, EndTime, Weekday) VALUES (93847, 'CS1026', 438169386, 'NATSCI1', '09:30:00', '11:30:00', 1);

CREATE TABLE STUCENTR.Lab (
    LabID INT NOT NULL,
    CourseID VARCHAR(10) NOT NULL,
    ProfessorID INT NOT NULL,
    RoomID VARCHAR(10) NOT NULL,
    StartTime TIME NOT NULL,
    EndTime TIME NOT NULL,
    Weekday INT NOT NULL,
    FOREIGN KEY (CourseID) REFERENCES STUCENTR.Course(CourseID),
    FOREIGN KEY (ProfessorID) REFERENCES STUCENTR.Professor(ProfessorID),
    FOREIGN KEY (RoomID) REFERENCES STUCENTR.Room(RoomID),
    PRIMARY KEY(LabID, CourseID)
);

CREATE TABLE STUCENTR.LabEnrollment (
    LabID INT NOT NULL,
    CourseID VARCHAR(10) NOT NULL,
    StudentID INT NOT NULL,
    AttendanceDate DATE,
    AttendanceStatus VARCHAR(20),
    FOREIGN KEY (LabID, CourseID) REFERENCES STUCENTR.Lab(LabID, CourseID),
    FOREIGN KEY (StudentID) REFERENCES STUCENTR.Student(StudentID),
    PRIMARY KEY (StudentID, LabID, CourseID)
);

ALTER TABLE STUCENTR.LabEnrollment
DROP COLUMN AttendanceDate;

ALTER TABLE STUCENTR.Lab
ADD COLUMN AttendanceDate DATE;

INSERT INTO STUCENTR.LabEnrollment (LabID, CourseID, StudentID) VALUES (32453, 'CS1026', 823321975);

INSERT INTO STUCENTR.Lab (LabID, CourseID, ProfessorID, RoomID, StartTime, EndTime, Weekday) VALUES (32453, 'CS1026', 438169386, 'NATSCI1', '13:30:00', '14:30:00', 3);

DELETE FROM STUCENTR.Lab WHERE LabID = 32453;

INSERT INTO STUCENTR.ProgramReq (ProgramID, CourseID) VALUES (1, 'CS3377');

	
	